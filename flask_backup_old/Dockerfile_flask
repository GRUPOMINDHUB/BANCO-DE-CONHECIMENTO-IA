# Dockerfile para Django em Cloud Run
FROM python:3.11-slim

# Define diretório de trabalho
WORKDIR /app

# Copia requirements primeiro (cache de layer)
COPY requirements.txt .

# Instala dependências
RUN pip install --no-cache-dir -r requirements.txt

# Copia código da aplicação
COPY . .

# Copia credenciais do Google Drive (do diretório raiz)
COPY ../credentials.json ./credentials.json

# Coleta arquivos estáticos do Django
RUN python manage.py collectstatic --noinput

# Expõe porta
EXPOSE 8080

# Comando de inicialização com Gunicorn
CMD exec gunicorn --bind :$PORT --workers 1 --threads 8 --timeout 0 config.wsgi:application
